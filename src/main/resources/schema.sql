CREATE TABLE IF NOT EXISTS MPA (
	MPA_ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	MPA_NAME VARCHAR(100) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS FILMS (
	FILM_ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	FILM_NAME VARCHAR(255) NOT NULL,
	FILM_DESCRIPTION VARCHAR(200),
	FILM_RELEASE_DATE DATE NOT NULL,
	FILM_DURATION BIGINT NOT NULL,
	FILM_MPA BIGINT REFERENCES MPA (MPA_ID)
);

CREATE TABLE IF NOT EXISTS USERS (
	USER_ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	USER_NAME VARCHAR,
	USER_EMAIL VARCHAR(255) NOT NULL UNIQUE,
	USER_LOGIN VARCHAR(255) NOT NULL UNIQUE,
	USER_BIRTHDAY DATE NOT NULL
);

CREATE TABLE IF NOT EXISTS GENRES (
	GENRE_ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	GENRE_NAME VARCHAR(100) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS USER_LIKES (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	USER_ID BIGINT REFERENCES USERS (USER_ID) ON DELETE CASCADE,
	FILM_ID BIGINT REFERENCES FILMS (FILM_ID),
	UNIQUE(user_id, film_id)
);

CREATE TABLE IF NOT EXISTS FILM_GENRES (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    FILM_ID  BIGINT REFERENCES FILMS (FILM_ID),
    GENRE_ID BIGINT REFERENCES GENRES (GENRE_ID)
);

CREATE TABLE IF NOT EXISTS FRIENDSHIP (
    FRIENDSHIP_ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	FRIENDSHIP_USER_ID BIGINT NOT NULL REFERENCES users (USER_ID) ON DELETE CASCADE,
	FRIENDSHIP_FRIEND_ID BIGINT NOT NULL REFERENCES users (USER_ID) ON DELETE CASCADE,
	UNIQUE(FRIENDSHIP_USER_ID, FRIENDSHIP_FRIEND_ID)
);